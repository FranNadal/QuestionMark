<!DOCTYPE html>
<html>
<head>
    <title>Perfil de Usuario</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-purple.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(to bottom, #f7f3fc, #ffffff);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .perfil-container {
            max-width: 800px;
            margin: auto;
        }
        .perfil-img {
            width: 120px;
            height: 120px;
            object-fit: cover;
        }
        /* Navbar consistente con el lobby */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0;
        }
        .navbar-logo {
            flex: 1;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 10px 20px;
        }
        .navbar-logo img {
            height: 40px;
            transition: transform 0.1s ease;
            cursor: pointer;
        }
        .navbar-logo img:hover {
            transform: scale(1.05);
        }
        .navbar-logo img:active {
            transform: scale(0.9) translateY(2px);
        }
        .navbar-center {
            flex: 1;
            display: flex;
            justify-content: center;
        }
        .navbar-center a {
            text-decoration: none;
            color: white;
            font-weight: bold;
            background-color: #6a1b9a;
            padding: 8px 16px;
            border-radius: 5px;
            border: 0.5px solid #ffffff; /* Borde de medio píxel */
            font-size: 16px; /* o el tamaño que prefieras */
            font-weight: bold;
        }
        .navbar-right {
            flex: 1;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 10px 20px;
        }
        .navbar-right a, .navbar-right span {
            text-decoration: none;
            color: white;
            font-weight: bold;
            margin-left: 10px;
        }
        .navbar-center a {
            display: inline-block;
            text-decoration: none;
            color: #ffffff;
            animation: jump 3s ease-in-out infinite;
            animation-delay: 5s; /* espera inicial antes de empezar a saltar */
        }

        /* Animación */
        @keyframes jump {
            0%, 100% { transform: translateY(0); }
            10% { transform: translateY(-5px); }
            20% { transform: translateY(0); }
        }

        .perfil-qr-container {
            width: 120px;
            height: 120px;
            margin: 0 auto 1rem;
            perspective: 1000px;
            cursor: pointer;
        }
        .flip-card {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .flip-card.flipped {
            transform: rotateY(180deg);
        }
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 12.2%;
            backface-visibility: hidden;
            border: 3px solid purple;
        }
        .flip-card-front img, .flip-card-back img {
            width: 100%;
            height: 100%;
            border-radius: 10%;
            object-fit: cover;
            display: block;
        }
        .flip-card-back {
            transform: rotateY(180deg);
            background: white;
        }

        @keyframes click {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(4px);
            }
        }

        #indicador-puntero {
            position: fixed;
            bottom: -27px;  /* distancia del borde inferior */
            right: -30px;   /* distancia del borde derecho */
            width: 70px;   /* ajusta el tamaño que necesites */
            height: auto;
            z-index: 1000; /* para que esté por encima de otros elementos */
            pointer-events: none;
            animation: click 1.5s ease-in-out infinite;
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.3));
        }

    </style>
</head>
<body>

<!-- Navbar superior -->
<div class="w3-bar w3-theme navbar">
    <div class="navbar-logo">
        <a href="/QuestionMark/home/view"><img src="/QuestionMark/view/img_page/logo2.png" alt="Logo"></a>
    </div>
    <div class="navbar-center">
        <a href="#">JUGAR</a>
    </div>
    <div class="navbar-right">
        <a href="#">Ranking</a>
        <a href="/QuestionMark/perfil/view">Perfil</a>
        <a href="/QuestionMark/login/logout">Desconectarse</a>
        <span><i class="fa fa-trophy"></i> Puntuación 1250</span>
    </div>
</div>

{{#datos}}
    <form method="POST" action="/QuestionMark/perfil/guardar" enctype="multipart/form-data" class="w3-container w3-padding-32 perfil-container">
    <div class="w3-card w3-white w3-round-large w3-padding-large">
            <div class="w3-center">
                <div class="perfil-qr-container" id="perfilQrContainer" title="Click para mostrar código QR">
                    <div class="flip-card" id="flipCard">
                        <div class="flip-card-front">
                            <img src="/QuestionMark/{{foto_perfil}}" alt="Foto de perfil" class="w3-circle perfil-img">
                        </div>
                        <div class="flip-card-back">
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=http://localhost/QuestionMark/perfil/view?user={{nombre_usuario}}" alt="Código QR del perfil">
                        </div>
                    </div>
                    <img src="/QuestionMark/view/img_page/indicador.png" alt="Indicador" id="indicador-puntero">

                </div>

                <h2 class="w3-text-purple">{{nombre_completo}}</h2>
                <p>{{nombre_usuario}}</p>
                <span class="w3-tag w3-theme w3-round">{{rol}}</span>

            </div>

            <hr class="w3-border-purple">

            <div class="w3-row-padding w3-margin-top">
                {{#edicion_perfil}}
                    <div class="w3-half w3-margin-bottom">
                        <b>Año de nacimiento:</b>
                        <input type="number" name="ano_nacimiento" value="{{ano_nacimiento}}" required>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Sexo:</b>
                        <select name="sexo" required>
                            <option value="M" {{#sexoM}}selected{{/sexoM}}>M</option>
                            <option value="F" {{#sexoF}}selected{{/sexoF}}>F</option>
                            <option value="N" {{#sexoN}}selected{{/sexoN}}>N</option>
                        </select>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>País:</b>
                        <input type="text" name="pais" value="{{pais}}">
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Ciudad:</b>
                        <input type="text" name="ciudad" value="{{ciudad}}">
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Email:</b>
                        <input type="email" name="email" value="{{email}}" required>
                    </div>
                    <div class="w3-center w3-margin-bottom">
                        <label for="foto">Cambiar foto de perfil:</label>
                        <input type="file" id="foto" name="foto" accept="image/*">
                    </div>

                {{/edicion_perfil}}

                {{^edicion_perfil}}
                    <div class="w3-half w3-margin-bottom">
                        <b>Año de nacimiento:</b>
                        <p>{{ano_nacimiento}}</p>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Sexo:</b>
                        <p>{{sexo}}</p>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>País:</b>
                        <p>{{pais}}</p>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Ciudad:</b>
                        <p>{{ciudad}}</p>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Email:</b>
                        <p>{{email}}</p>
                    </div>
                    <div class="w3-half w3-margin-bottom">
                        <b>Fecha de registro:</b>
                        <p>{{fecha_registro}}</p>
                    </div>
                {{/edicion_perfil}}
            </div>

            <div class="w3-center w3-margin-top">
                {{#edicion_perfil}}
                    <button type="submit" class="w3-button w3-round-large" style="background-color: purple; color: white;">Guardar</button>
                {{/edicion_perfil}}

                {{^edicion_perfil}}
                    <a href="/QuestionMark/perfil/editar" class="w3-button w3-purple w3-round-large">Editar perfil</a>
                {{/edicion_perfil}}
            </div>
        </div>
    </form>
{{/datos}}
<script>
    document.getElementById('perfilQrContainer').addEventListener('click', function () {
        document.getElementById('flipCard').classList.toggle('flipped');
    });
</script>
</body>
</html>
